# redis

- 概念： redis是一款高性能的NOSQL(Not Only SQL)系列的非关系型数据库，为解决大规模数据集合多重数据种类带来的挑战，尤其是大数据应用难题
- 区别
  - 关系型数据库数据之间有关联关系，存储在硬盘文件中
  - NOSQL数据之间用键值对存储，没有关联，存储在内存中

- 优点
  - 开源便宜
  - 数据存储于缓存之中速度快
  - 存储形式多：key,value形式、文档形式、图片形式等
  - 扩展性强，不用join其他表

- 缺点
  - 新技术维护难
  - 不支持sql
  - 不提供关系型数据库对事务的处理

- 总结
  - 两者互补而非对立
  - 一般会将数据存储在关系型数据库中，在nosql数据库中备份存储关系型数据库的数据

- 分类：键值存储、列存储、文档型、图形数据库
- 安装
  - redis.windows.conf：配置文件
  - redis-cli.exe：redis的客户端
  - redis-server.exe：redis服务器端

## 数据结构

- redis存储的是key,value格式的数据，其中key是字符串，value有5种不同的数据结构
  - 字符串类型 string
    - 存储：`set key value`
    - 获取：`get key`
    - 删除：`del key`
  - 哈希类型 hash：map格式
    - 存储：`hset key field value`
    - 获取：`hget key field` `hgetall key`
    - 删除：`hdel key field`
  - 列表类型 list ：linkedlist格式，支持重复元素
    - 存储：可以添加一个元素到列表的头部（左边）或者尾部（右边）`lpush key value` `rpush key value`
    - 获取：`lrange key start end`，获取所有的话end传-1
    - 删除：`lpop key` ` rpop key`
  - 集合类型 set：不允许重复元素
    - 存储：`sadd key value`
    - 获取：`smembers key`
    - 删除：`srem key value`
  - 有序集合类型 sortedset：不允许重复元素，且元素有顺序；每个元素都会关联一个double类型的分数，按照分数进行排序
    - 存储：`zadd key score value`
    - 获取：`zrange key start end [withscores]`
    - 删除：`zrem key value`
  - 通用命令
    - 查询所有的键：`keys *`
    - 获取键对应的value的类型：`type key`
    - 删除指定的key value：`del key`

## 持久化

- RDB：默认方式，不需要进行配置；在一定的间隔时间中，检测key的变化情况，然后持久化数据
  1. 编辑redis.windwos.conf文件：`save 900 1`：900秒后如果至少1个key变化了就存储
  2. 重新启动redis服务器，并指定配置文件名称：`redis-server.exe redis.windows.conf	`
- AOF：日志记录方式，可以记录每一条命令操作，并在每一次命令操作后持久化数据
  1. 编辑redis.windwos.conf文件：
     - `appendonly yes`开启持久化
     - `# appendfsync always` ：每一次操作都进行持久化
     - `# appendfsync everysec` ：每隔一秒进行一次持久化
     - `# appendfsync no`：不进行持久化

# Jedis

- `Jedis jedis = new Jedis("localhost",6379); jedis.close();`

- jedis连接池：JedisPool

  1. 配置

     ```java
     JedisPoolConfig config = new JedisPoolConfig();
             config.setMaxTotal(50);
             config.setMaxIdle(10);
     ```

  2. 创建JedisPool连接池对象：`JedisPool jedisPool = new JedisPool(config, "localhost", 6379);`

  3. 调用方法 getResource()方法获取Jedis连接

  4. 使用与归还同上